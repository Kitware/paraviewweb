<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>ParaViewWeb</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://kitware.github.io/paraviewweb/docs/os_mesa.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://kitware.github.io/paraviewweb/docs/os_mesa.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/paraviewweb/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/paraviewweb/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/paraviewweb/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/paraviewweb/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/paraviewweb/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/paraviewweb/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/paraviewweb/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/paraviewweb/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/paraviewweb/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/paraviewweb/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/paraviewweb/atom.xml" title="ParaViewWeb">
  <!-- Open Graph -->
  <meta name="description" content="How to build an Off-screen ParaViewWeb serverIntroductionWeb servers do not always come with a GPU. In addition, small 3D models can easily be handled by software rendering.This documentation will foc">
<meta property="og:type" content="website">
<meta property="og:title" content="ParaViewWeb">
<meta property="og:url" content="https://kitware.github.io/paraviewweb/docs/os_mesa.html">
<meta property="og:site_name" content="ParaViewWeb">
<meta property="og:description" content="How to build an Off-screen ParaViewWeb serverIntroductionWeb servers do not always come with a GPU. In addition, small 3D models can easily be handled by software rendering.This documentation will foc">
<meta property="og:updated_time" content="2017-05-04T22:40:50.566Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ParaViewWeb">
<meta name="twitter:description" content="How to build an Off-screen ParaViewWeb serverIntroductionWeb servers do not always come with a GPU. In addition, small 3D models can easily be handled by software rendering.This documentation will foc">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90338862-2', 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/paraviewweb/" id="logo">ParaViewWeb</a>
    </h1>
    <nav id="main-nav">
      <a href="/paraviewweb/docs/" class="main-nav-link">Docs</a><a href="/paraviewweb/api/" class="main-nav-link">API</a><a href="/paraviewweb/examples/" class="main-nav-link">Examples</a><a href="/paraviewweb/applications/" class="main-nav-link">Applications</a>
      <a href="https://github.com/kitware/paraviewweb" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name"></h1>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h1 id="How-to-build-an-Off-screen-ParaViewWeb-server" class="article-heading"><a href="#How-to-build-an-Off-screen-ParaViewWeb-server" class="headerlink" title="How to build an Off-screen ParaViewWeb server"></a>How to build an Off-screen ParaViewWeb server<a class="article-anchor" href="#How-to-build-an-Off-screen-ParaViewWeb-server" aria-hidden="true"></a></h1><h2 id="Introduction" class="article-heading"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction<a class="article-anchor" href="#Introduction" aria-hidden="true"></a></h2><p>Web servers do not always come with a GPU. In addition, small 3D models can easily be handled by software rendering.<br>This documentation will focus on how to build ParaView so that it can be used in a headless environment for ParaViewWeb. This only applies for a Linux base system.</p>
<h2 id="Building-the-application" class="article-heading"><a href="#Building-the-application" class="headerlink" title="Building the application"></a>Building the application<a class="article-anchor" href="#Building-the-application" aria-hidden="true"></a></h2><h3 id="OSMesa" class="article-heading"><a href="#OSMesa" class="headerlink" title="OSMesa"></a>OSMesa<a class="article-anchor" href="#OSMesa" aria-hidden="true"></a></h3><p>More informations can be found in the <a href="http://paraview.org/Wiki/ParaView/ParaView_And_Mesa_3D" target="_blank" rel="external">wiki</a>, but this page provides a nice and easy summary.</p>
<p>The Mesa 11.0.7 OSMesa Gallium llvmpipe state-tracker is the preferred Mesa back-end renderer for ParaView and VTK. The following shows how to configure it with system installed LLVM. Our strategy is to configure Mesa with the minimal number of options needed for OSMesa. This greatly simplifies the build, as many of the other drivers/renderers depend on X11 or other libraries. The following set of options are from the Mesa v11.0.7 release. Older or newer releases may require slightly different options. Consult ./configure –help for the details.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"></div><div class="line">make -j4 distclean <span class="comment"># if in an existing build</span></div><div class="line"></div><div class="line">autoreconf -fi</div><div class="line"></div><div class="line">./configure \</div><div class="line">    CXXFLAGS=<span class="string">"-O2 -g -DDEFAULT_SOFTWARE_DEPTH_BITS=31"</span> \</div><div class="line">    CFLAGS=<span class="string">"-O2 -g -DDEFAULT_SOFTWARE_DEPTH_BITS=31"</span> \</div><div class="line">    --disable-xvmc \</div><div class="line">    --disable-glx \</div><div class="line">    --disable-dri \</div><div class="line">    --with-dri-drivers=<span class="string">""</span> \</div><div class="line">    --with-gallium-drivers=<span class="string">"swrast"</span> \</div><div class="line">    --disable-shared-glapi \</div><div class="line">    --disable-egl \</div><div class="line">    --with-egl-platforms=<span class="string">""</span> \</div><div class="line">    --enable-gallium-osmesa \</div><div class="line">    --enable-gallium-llvm=yes \</div><div class="line">    --enable-llvm-shared-libs \</div><div class="line">    --disable-gles1 \</div><div class="line">    --disable-gles2 \</div><div class="line">    --prefix=/opt/mesa/11.0.7/llvmpipe</div><div class="line"></div><div class="line">make -j2</div><div class="line">make -j4 install</div></pre></td></tr></table></figure>
<p>Some explanation of these options:</p>
<ul>
<li><p>DEFAULT_SOFTWARE_DEPTH_BITS=31<br>This sets the internal depth buffer precision for the OSMesa rendering context. In our experience, this is necessary to avoid z-buffer fighting during parallel rendering. Note that we have used this in-place of –with-osmesa-bits=32, which sets both depth buffer and color buffers to 32 bit precision. Because of a bug in Mesa, this introduces over 80 ctest regression failures in VTK related to line drawing.</p>
</li>
<li><p>–enable-texture-float<br>Floating point textures are disabled by default due to patent restrictions. They must be enabled for many advanced VTK algorithms.</p>
</li>
</ul>
<h3 id="ParaView" class="article-heading"><a href="#ParaView" class="headerlink" title="ParaView"></a>ParaView<a class="article-anchor" href="#ParaView" aria-hidden="true"></a></h3><p>ParaView needs to be built from source in order to take advantage of your OSMesa build.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> ParaViewWeb</div><div class="line">$ mkdir ParaView</div><div class="line">$ <span class="built_in">cd</span> ParaView</div><div class="line">$ mkdir build install</div><div class="line">$ git <span class="built_in">clone</span> git://paraview.org/stage/ParaView.git src</div><div class="line">$ <span class="built_in">cd</span> src</div><div class="line">$ git submodule update --init</div><div class="line">$ <span class="built_in">cd</span> ../build</div><div class="line">$ ccmake ../src</div><div class="line"></div><div class="line">    PARAVIEW_ENABLE_PYTHON      ON</div><div class="line">    PARAVIEW_BUILD_QT_GUI       OFF</div><div class="line">    CMAKE_INSTALL_PREFIX        /.../ParaView/install</div><div class="line">    VTK_USE_X                   OFF</div><div class="line">    OPENGL_INCLUDE_DIR          /opt/mesa/11.0.7/llvmpipe/include</div><div class="line">    OPENGL_gl_LIBRARY</div><div class="line">    OPENGL_glu_LIBRARY          /opt/mesa/11.0.7/llvmpipe/lib/libGLU.[so|a]</div><div class="line">    VTK_OPENGL_HAS_OSMESA       ON</div><div class="line">    OSMESA_INCLUDE_DIR          /opt/mesa/11.0.7/llvmpipe/include</div><div class="line">    OSMESA_LIBRARY              /opt/mesa/11.0.7/llvmpipe/lib/libOSMesa.[so|a]</div><div class="line"></div><div class="line">$ make</div><div class="line">$ make install</div></pre></td></tr></table></figure>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2017-05-04T22:40:50.566Z" itemprop="dateModified">Last updated: 2017-05-04</time>
                <a href="graphics_on_ec2_g2.html" class="article-footer-prev" title="EC2"><i class="fa fa-chevron-left"></i><span>Prev</span></a><a href="virtualgl_turbovnc_howto.html" class="article-footer-next" title="VirtualGL and TurboVNC"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#How-to-build-an-Off-screen-ParaViewWeb-server"><span class="toc-text">How to build an Off-screen ParaViewWeb server</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Building-the-application"><span class="toc-text">Building the application</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OSMesa"><span class="toc-text">OSMesa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ParaView"><span class="toc-text">ParaView</span></a></li></ol></li></ol></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner"><strong class="sidebar-title">Getting Started</strong><a href="index.html" class="sidebar-link">Overview</a><a href="setup.html" class="sidebar-link">Setup</a><a href="roadmap.html" class="sidebar-link">Roadmap</a><a href="events.html" class="sidebar-link">Events</a><a href="https://github.com/Kitware/paraviewweb/releases" class="sidebar-link">Releases</a><strong class="sidebar-title">Basic Usage</strong><a href="import.html" class="sidebar-link">Import</a><strong class="sidebar-title">Miscellaneous</strong><a href="tools.html" class="sidebar-link">Developer guide</a><a href="troubleshooting.html" class="sidebar-link">Troubleshooting</a><a href="contributing.html" class="sidebar-link">Contributing</a><strong class="sidebar-title">Server</strong><a href="architecture.html" class="sidebar-link">Architecture</a><a href="multi_user_setup.html" class="sidebar-link">Multi-user setup</a><a href="apache_front_end.html" class="sidebar-link">Using Apache</a><a href="ami.html" class="sidebar-link">EC2 AMIs</a><strong class="sidebar-title">Launchers</strong><a href="launcher_api.html" class="sidebar-link">API</a><a href="python_launcher.html" class="sidebar-link">Python</a><a href="launching_examples.html" class="sidebar-link">Examples</a><strong class="sidebar-title">Graphics setup</strong><a href="graphics_on_ec2_g2.html" class="sidebar-link">EC2</a><a href="os_mesa.html" class="sidebar-link current">Offscreen OSMesa</a><a href="virtualgl_turbovnc_howto.html" class="sidebar-link">VirtualGL and TurboVNC</a><strong class="sidebar-title">Deployment</strong><a href="ubuntu_14_04.html" class="sidebar-link">Ubuntu 14.04 LTS</a><a href="windows_10.html" class="sidebar-link">Windows 10</a><a href="ansible.html" class="sidebar-link">Ansible playbook</a><a href="vagrant.html" class="sidebar-link">Vangrant setup</a><a href="nvidia_redhat.html" class="sidebar-link">Nvidia on RedHat</a><strong class="sidebar-title">Compilation</strong><a href="configure_and_build_vtkweb.html" class="sidebar-link">VTK</a><a href="configure_and_build_pvweb.html" class="sidebar-link">ParaView</a></div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2017 <a href="http://www.kitware.com" target="_blank">Kitware Inc.</a>
    </div>
    <div id="footer-links">
      <a href="https://github.com/kitware/paraviewweb" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/paraviewweb/docs/" class="mobile-nav-link">Docs</a><a href="/paraviewweb/api/" class="mobile-nav-link">API</a><a href="/paraviewweb/examples/" class="mobile-nav-link">Examples</a><a href="/paraviewweb/applications/" class="mobile-nav-link">Applications</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/kitware/paraviewweb" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Getting Started</strong><a href="index.html" class="mobile-nav-link">Overview</a><a href="setup.html" class="mobile-nav-link">Setup</a><a href="roadmap.html" class="mobile-nav-link">Roadmap</a><a href="events.html" class="mobile-nav-link">Events</a><a href="https://github.com/Kitware/paraviewweb/releases" class="mobile-nav-link">Releases</a><strong class="mobile-nav-title">Basic Usage</strong><a href="import.html" class="mobile-nav-link">Import</a><strong class="mobile-nav-title">Miscellaneous</strong><a href="tools.html" class="mobile-nav-link">Developer guide</a><a href="troubleshooting.html" class="mobile-nav-link">Troubleshooting</a><a href="contributing.html" class="mobile-nav-link">Contributing</a><strong class="mobile-nav-title">Server</strong><a href="architecture.html" class="mobile-nav-link">Architecture</a><a href="multi_user_setup.html" class="mobile-nav-link">Multi-user setup</a><a href="apache_front_end.html" class="mobile-nav-link">Using Apache</a><a href="ami.html" class="mobile-nav-link">EC2 AMIs</a><strong class="mobile-nav-title">Launchers</strong><a href="launcher_api.html" class="mobile-nav-link">API</a><a href="python_launcher.html" class="mobile-nav-link">Python</a><a href="launching_examples.html" class="mobile-nav-link">Examples</a><strong class="mobile-nav-title">Graphics setup</strong><a href="graphics_on_ec2_g2.html" class="mobile-nav-link">EC2</a><a href="os_mesa.html" class="mobile-nav-link current">Offscreen OSMesa</a><a href="virtualgl_turbovnc_howto.html" class="mobile-nav-link">VirtualGL and TurboVNC</a><strong class="mobile-nav-title">Deployment</strong><a href="ubuntu_14_04.html" class="mobile-nav-link">Ubuntu 14.04 LTS</a><a href="windows_10.html" class="mobile-nav-link">Windows 10</a><a href="ansible.html" class="mobile-nav-link">Ansible playbook</a><a href="vagrant.html" class="mobile-nav-link">Vangrant setup</a><a href="nvidia_redhat.html" class="mobile-nav-link">Nvidia on RedHat</a><strong class="mobile-nav-title">Compilation</strong><a href="configure_and_build_vtkweb.html" class="mobile-nav-link">VTK</a><a href="configure_and_build_pvweb.html" class="mobile-nav-link">ParaView</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="docs/os_mesa.html">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/paraviewweb/js/lang_select.js"></script>
<script src="/paraviewweb/js/toc.js"></script>
<script src="/paraviewweb/js/mobile_nav.js"></script>
<!-- endbuild -->
<script src="https://cdn.jsdelivr.net/retinajs/1.3.0/retina.min.js" async></script>



</body>
</html>